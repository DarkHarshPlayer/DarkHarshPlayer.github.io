<html>
<head>
    <title id="PageTitle">Music Player-Dark Edition</title>
    <link href="https://fonts.googleapis.com/css?family=Chewy" rel="stylesheet">
    <link rel="stylesheet" href="main.css">

    <!-- Favicon -->

    <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/manifest.json">
    <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">

    <!--- End -->
    <link rel="stylesheet" href="track.css">
    <link rel="prefetch" href="asset/vol%203.png">
    <link rel="prefetch" href="asset/vol%201.png">
    <link rel="prefetch" href="asset/vol%202.png">
    <link rel="prefetch" href="asset/menu/stack.png">
    <link rel="prefetch" href="asset/menu/menu.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script src="db.js"></script>
   <script>
    let isup = false;

</script></head>
<body>

<center>
    <div class="volume">
        <img class="volume_ico"onclick="songMute()" id="volume_ico" src="asset/vol%203.png" height="20" width="18">
        <input type="range" oninput="volumeChange()" min="1" max="100" value="77" class="slider" id="volSlider">
    </div>
    <div class="infoButton" onclick="infoPanel.classList.add('infoPanelUp')">
    <img src="asset/info.png" height="20" width="20">
    </div>
    <div class="infoPanel" id="infoPanel">
        <div class="ccc">
    <div class=" close-button" onclick="infoPanel.classList.remove('infoPanelUp');"></div>
        </div>
        <h1>Dark Music Player</h1>
        <h6>A fun project made by Harsh</h6>
        <p>Your Browser Should be in the latest version otherwise you might experience problem in playing songs and in other function.</p>
        <p>If you are facing any kind of problems while playing the song it might be because your internet connection is slow and the song is buffering.
        Please wait till the song buffers.</p>
        <p>All the songs and media used here belongs to their respected artist and owner.</p>
        <p>This site still under development. New songs and features will be added soon.</p>
        <p>If you cant find your favorite song.You can send a request by e-mail. I'll try my best to upload your requested song.</p>
        <code><a href="mailto:harshbanjare007@outlook.com">Harshbanjare007@outlook.com</a></code>
        <center class="copyRight">&copy;Harsh 2017</center>
    </div>
    <img class="previous" onclick="prevSong()" src="asset/previous.png">
    <div class="albumart">
        <img class="albumpic" id="albumPic"src="Divide%20Album%20Cover.jpg">
    </div>
    <img class="next" onclick="nextSong()" src="asset/previous.png">
    <audio class="music" src="05%20-%20Perfect.mp3" onpause="playButton.style.display = 'block'" onplay="playButton.style.display = 'none'" id="music" controls ></audio>
    <div class="trackInfo">
        <div class="title" id="mainTitle">Perfect</div>
        <div class="artist" id="mainArtist">Ed Sheeran</div>
    </div>

    <div class="seekPanel">
        <span class="currentTime" id="currentTime">00:00</span>
        <input type="range"  min="1" max="100" value="52" step="0.00001" class="seeker" id="seeker">
        <span class="duration" id="duration">00:00</span>
    </div>

    <div class="control_panel">
        <img class="prevS" onclick="prevSong()" src="asset/prevsong.png" height="42" width="42">

        <img class="play_pause" onclick="play_pause()" src="asset/pause.png" height='33' width='35' id="play_pause">
        <img class="play_pause1" onclick="play_pause()" src="asset/play.png" height='33' width='35' id="play_pause1">

        <img class="nextS" onclick="nextSong()" src="asset/prevsong.png" height="42" width="42">
    </div>

    <div class="songList" id="songList">
        <div class="uplifter1" id="l6"onclick="


 songSearchkey.value = '';
 searchSong();
           if(isup){
              songList.classList.remove('songListLifter');l6.classList.remove('upliftarrow');l3.classList.remove('upliftarrow');
              isup = false;
           }else{
        songList.classList.add('songListLifter');l6.classList.add('upliftarrow');l3.classList.add('upliftarrow');
        isup = true;
        }

" ></div>
        <div class="songHead" id="l2" onclick="


        songSearchkey.value = '';
        searchSong();
       if(isup){
              songList.classList.remove('songListLifter');l6.classList.remove('upliftarrow');l3.classList.remove('upliftarrow');
              isup = false;
           }else{
        songList.classList.add('songListLifter');l6.classList.add('upliftarrow');l3.classList.add('upliftarrow');
        isup = true;
        }
">Songs</div>
        <img class="uplifter2" id='l3'onclick="

 songSearchkey.value = '';
 searchSong();
         if(isup){
              songList.classList.remove('songListLifter');l6.classList.remove('upliftarrow');l3.classList.remove('upliftarrow');
              isup = false;
           }else{
        songList.classList.add('songListLifter');l6.classList.add('upliftarrow');l3.classList.add('upliftarrow');
        isup = true;
        }
" src="asset/previous.png"><br>
        <div class="songSearch">
            <div class="songSearchBar">

                <input type="text" id="songSearchkey" onkeyup="searchSong()" class="songsearchkey" placeholder="Search...">
                <img onclick="searchSong()" src="asset/search.png" class="songSearchIcon">
                <div class="unStacker" onclick="stacker()">
                    <img class="UnStackerIco" id="menuer" src="asset/menu/menu.png">
                </div>
            </div>
        </div><br>
        <div class="songListAppender" id="songListAppender">
            <!--<div class="track" ><img src='http://placekitten.com/200/200'><div class='trackData'><span class='trackSongName'>"+this.name+"</span><span class='trackNameSeparator'>|</span><span class='trackArtist'>"+this.artist+"</span></div></div>-->
        </div>
    </div>
</center>

</body>
<script>
    let music = document.getElementById('music');
    let playButton =  document.getElementById('play_pause');
    let volumeSlider = document.getElementById('volSlider');
    let mainArtist = document.getElementById('mainArtist');
    let mainTitle = document.getElementById('mainTitle');
    let albumArt = document.getElementById('albumPic');
    let currentTime = document.getElementById('currentTime');
    let duration = document.getElementById('duration');
    let seeker = document.getElementById('seeker');
    let currentSong = 0;
    let input , track , trackdata , a , b ;
    let trackI = document.getElementsByClassName('SearchTrack');
    let songlistappender = document.getElementById('songListAppender');
    let volume_ico = document.getElementById('volume_ico');
    let menuer = document.getElementById('menuer');
    let isStack = false;
    function stacker() {
        if(isStack){
           isStack = false;
            songlistappender.classList.remove('songListAppenderStacked');
            songlistappender.classList.add('songListAppender');
            for(let i = 0; i < trackI.length;i++){
                trackI[i].classList.remove('trackStacked');
                trackI[i].classList.add('track')
            }
            menuer.src = "asset/menu/menu.png";
        }else {
            isStack = true;
            songlistappender.classList.remove('songListAppender');
            songlistappender.classList.add('songListAppenderStacked');
            for(let i = 0; i < trackI.length;i++){
                trackI[i].classList.remove('track');
                trackI[i].classList.add('trackStacked')
            }
            menuer.src = "asset/menu/stack.png";
        }
    }

    function append() {
        for (let i = 0 ;i<songsDB.length;i++){
            new Track(songsDB[i].name,songsDB[i].src,songsDB[i].artist,songsDB[i].album,i);
        }
    }



    function Track(name,src,artist,album,id) {
        this.name = name;
        this.src = src;
        this.artist = artist;
        this.album  = album;
        this.id = id;
        let vari = "playDemand('"+ this.id +"')";
        let trac = "<div class=\"track SearchTrack\" onclick="+vari+"><img src='"+this.album+"'><br><div class='trackData'><span class='trackSongName'>"+this.name+"</span><span class='trackNameSeparator'>|</span><span class='trackArtist'>"+this.artist+"</span></div></div> ";
        songlistappender.innerHTML += trac;
    }

    function playDemand(id) {
        music.src = songsDB[id].src;
        music.play();
        playButton.style.display = "none";
        musicispause = false;
        let artist = songsDB[id].artist;
        let title  = songsDB[id].name;
        let picArt = songsDB[id].album;
        albumArt.src = picArt;
        mainTitle.innerHTML = title;
        mainArtist.innerHTML = artist;
        currentSong = id;
       document.title = songsDB[id].name +"-"+songsDB[id].artist+ ": On Dark Music Player";
    }

    function play_pause(){
        console.log(music.paused);
        if(music.paused){
            music.play();
            playButton.style.display = "none";

        }
        else{
            music.pause();
            playButton.style.display = "block";

        }

    }
    music.ontimeupdate = function () {
        timeCoordinater();
        seekbar();
        if(music.currentTime === music.duration){
            console.log(currentSong);
            if(currentSong >= songsDB.length-1){
                currentSong = 0;
                playDemand(currentSong);
            }else{
            currentSong++;playDemand(currentSong);
            }
        }
    };
    function searchSong(){
        songlistappender.scrollTop = songlistappender;

        input = document.getElementById('songSearchkey').value.toUpperCase();
        track = document.getElementsByClassName('searchTrack');
        // console.log(track.length);
        for (var i = 0; i < track.length; i++){
            // console.log('hi');
            trackdata = track[i].getElementsByClassName('trackData');
             //console.log(trackdata[0].children);
              a = trackdata[0].getElementsByClassName('trackSongName')[0];
              b = trackdata[0].getElementsByClassName('trackArtist')[0];
           // console.log(a.innerHTML+" | "+b.innerHTML);
            if(a.innerHTML.toUpperCase().indexOf(input) > -1 || b.innerHTML.toUpperCase().indexOf(input) > -1){
                track[i].style.display =  "";
            }else {
                track[i].style.display = "none";
            }

        }

    }
    function seekbar() {
        // console.log(seeker);
        seeker.value = (music.currentTime/music.duration)*100;
        // console.log(   (music.currentTime/music.duration)*100);
        // console.log(seeker.value);;
    }
    function nextSong() {
        if (currentSong >= songsDB.length-1){
            currentSong = 0;
        } else{
            currentSong++;
        }
        playDemand(currentSong);

    } function prevSong() {
        if (currentSong <= 0){
            currentSong = songsDB.length-1;
        } else{
            currentSong--;
        }
        playDemand(currentSong);
    }

    function songMute() {

        if(music.muted) {
            music.muted = false;
            volumeSlider.value = 70;
            volumeChange();
        }else {
            music.muted = true;
            volumeSlider.value = 0;
            volumeChange();
        }
    }
    function volumeChange(){
        if(volumeSlider.value < 50 && volumeSlider.value >= 3){
            volume_ico.src = "asset/vol%202.png";
            music.muted = false;
        }else if(volumeSlider.value < 3){
            volume_ico.src = "asset/vol%201.png";
            music.muted = true;
        }else {
            volume_ico.src = "asset/vol%203.png";
            music.muted = false
        }
        music.volume = (volumeSlider.value)/100;
    }

    function timeCoordinater() {
        if(isNaN(music.duration)){
            duration.innerText = '00:00';
            currentTime.innerText = toHHMMSS(music.currentTime);
        }else{
            currentTime.innerText = toHHMMSS(music.currentTime);
        duration.innerText = toHHMMSS(music.duration);}
    }
    var toHHMMSS = (secs) => {
        var sec_num = parseInt(secs, 10);
        var hours   = Math.floor(sec_num / 3600) % 24;
        var minutes = Math.floor(sec_num / 60) % 60;
        var seconds = sec_num % 60;
        return [hours,minutes,seconds]
            .map(v => v < 10 ? "0" + v : v)
            .filter((v,i) => v !== "00" || i > 0)
            .join(":")
    }
    window.onload = function(){
        music.volume = volumeSlider.value/100;
        //document.getElementById("loader").style.display = "none";
        append();

    };
    window.addEventListener('keydown',function (e) {
        if (e.keyCode == 32){play_pause();}
        else if (e.keyCode == 37){prevSong();}
        else if (e.keyCode == 39){nextSong();}
    });


</script>
</html>
